<!doctype html>
<html>
<head>
    <title>jQuery Finger</title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <link rel="stylesheet" href="normalize.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header>
        <h1>jQuery Finger</h1>
    </header>

    <main>
        <section>
            <blockquote>
                jQuery tap & gestures, fingers in the nose.
            </blockquote>

            <h2>Try it...</h2>

            <div class="touchzone-wrapper">
                <div class="touchzone" data-event></div>
            </div>

            <div class="actions">
                <a href="http://github.com/ngryman/jquery.finger/zipball/v0.0.6" class="icon-download">Download</a>
                <a href="http://github.com/ngryman/jquery.finger" class="icon-github-repo">Github</a>
            </div>

            <p>
                jQuery Finger unifies click and touch events by removing the 300ms delay on touch devices.
                It also provide a common set of events to handle basic gestures such as drag and pinch.
                Small (< 1kb gzipped), it is focused on performance, is well tested and ... also supports jQuery
                delegated events.
            </p>
        </section>

        <section>
            <h2>Try it</h2>

            <p>
                <strong>jQuery Finger</strong> unifies click and touch events by removing the 300ms delay on touch
                devices. It also provide a common set of events to handle basic gestures such as drag and pinch.
                Small (< 1kb gzipped), it is focused on performance, is well tested and ... also supports jQuery
                delegated events.
            </p>
        </section>
    </main>

    <footer></footer>

    <div class="warp"></div>

    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="jquery.finger.min.js"></script>
    <script>
        (function($) {

            // https://code.google.com/p/jquery-debounce/
            $.debounce = function(fn, timeout, invokeAsap, ctx) {

                if (arguments.length == 3 && typeof invokeAsap != 'boolean') {
                    ctx = invokeAsap;
                    invokeAsap = false;
                }

                var timer;

                return function() {

                    var args = arguments;
                    ctx = ctx || this;

                    invokeAsap && !timer && fn.apply(ctx, args);

                    clearTimeout(timer);

                    timer = setTimeout(function() {
                        invokeAsap || fn.apply(ctx, args);
                        timer = null;
                    }, timeout);

                };

            };

        })(jQuery);
    </script>
    <script>
        (function($) {
            $.fn.cssanim = function(animation, cls, reverse) {
                this.removeClass().addClass(cls);
                this[0].offsetWidth;
                return this.addClass(animation).addClass(reverse ? 'reverse' : '');
            };

            $.fn.cssreset = function() {
                return this.css({
                    transition: 'none',
                    transform: 'rotateY(0)'
                });
            };
        })(jQuery);
    </script>
    <script>
        var $touch = $('.touchzone');
        var $warp = $('.warp');
        var w, h;
        var colors = 'green blue pink'.split(' ');
        colors.index = 0;

        $touch.on('tap', function(e) {
            var x = e.x,
                y = e.y;

            $touch.cssreset().cssanim('tap', 'touchzone').attr('data-event', 'tap');
            $warp.cssanim('tap', 'warp');
            $warp.css({
                left: x - w / 20,
                top: y - w / 20,
                width: w / 10,
                height: w / 10
            });
        });

        $touch.on('doubletap', function(e) {
            $('html').removeClass(colors[colors.index]);
            colors.index = (colors.index + 1) % colors.length;
            $('html').addClass(colors[colors.index]);

            $touch.attr('data-event', 'doubletap');
        });

        $touch.on('drag', function(e) {
            var dx = e.dx,
                dy = e.dy;

            $touch.css({
                transition: !e.end ? 'none' : '.2s linear',
                transform: !e.end ? 'horizontal' == e.orientation ? 'rotateY(' + -dx / 2 + 'deg)' : 'rotateX(' + dy / 2 + 'deg)' : 'rotateY(0)'
            });
            $touch.cssanim('drag', 'touchzone').attr('data-event', 'drag');
        });
        
        $touch.on('flick', function(e) {
            $touch.cssreset().cssanim('flick-' + e.orientation, 'touchzone', -1 == e.direction).attr('data-event', 'flick');;
        });

        $(window).on('resize', $.debounce(function(e) {
            w = $touch.outerWidth();
            h = $touch.outerHeight();

            $('.touchzone-wrapper').css('perspective', $('.touchzone-wrapper').innerWidth());

        }, 100));
    </script>
</body>
</html>